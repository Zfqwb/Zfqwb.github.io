

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=&#34;auto&#34;>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" href="/img/favicon.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="">
  <meta name="author" content="nitto">
  <meta name="keywords" content="">
  
  <title>JDBC-01 - Hexo</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.4.0/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
  



<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->

  
<link rel="stylesheet" href="/css/toubudaziji.css">
<link rel="stylesheet" href="/css/gundongtiao.css">
<link rel="stylesheet" href="/css/shubiao.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"zfqwb.github.io","root":"/","version":"1.8.9","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":21111747,"cnzz":null,"leancloud":{"app_id":"bMWk1sw4iFwEPTeRxqFOkxvq-gzGzoHsz","app_key":"sDMo4aGFa1dFrXYs2oXkNaVY","server_url":"https://bmwk1sw4.lc-cn-n1-shared.com"}}};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  <meta name="baidu-site-verification" content="code-vbtyv0liY1" />
<meta name="generator" content="Hexo 5.4.0"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>nitto</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-link-fill"></i>
                友链
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;</a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" href="javascript:">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/img/default.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="JDBC-01">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2020-05-04 18:19" pubdate>
        2020年5月4日 晚上
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      7.5k 字
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      116
       分钟
    </span>
  

  
  
    
      <!-- 不蒜子统计文章PV -->
      <span id="busuanzi_container_page_pv" style="display: none">
        <i class="iconfont icon-eye" aria-hidden="true"></i>
        <span id="busuanzi_value_page_pv"></span> 次
      </span>
    
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">JDBC-01</h1>
            
              <p class="note note-info">
                
                  本文最后更新于：2 个月前
                
              </p>
            
            <div class="markdown-body">
              <h3 id="一、JDBC快速入门"><a href="#一、JDBC快速入门" class="headerlink" title="一、JDBC快速入门"></a>一、JDBC快速入门</h3><h4 id="1-jdbc的概念"><a href="#1-jdbc的概念" class="headerlink" title="1.jdbc的概念"></a>1.jdbc的概念</h4><ul>
<li>JDBC（Java DataBase Connectivity：java数据库连接）是一种用于执行SQL语句的Java API，可以为多种关系型数据库提供统一访问，它是由一组用Java语言编写的类和接口组成的。</li>
<li>JDBC的作用：可以通过java代码操作数据库</li>
</ul>
<h4 id="2-jdbc的本质"><a href="#2-jdbc的本质" class="headerlink" title="2.jdbc的本质"></a>2.jdbc的本质</h4><ul>
<li><p>其实就是java官方提供的一套规范(接口)。用于帮助开发人员快速实现不同关系型数据库的连接！</p>
</li>
<li><p>图示：</p>
<p><img src="/2020/05/04/jdbc01/img/jdbc.png" srcset="/img/loading.gif" lazyload></p>
</li>
<li><p>上图解释：</p>
<ul>
<li>如果没有jdbc，程序员想操作mysql，就需要学习mysql的一套操作规范</li>
<li>程序员想操作oracle，就需要学习oracle的一套操作规范，db2也是</li>
<li>这样做太麻烦了，这时候java就出了一套规范jdbc，用来操作所有的关系型数据库，然后各个数据库厂商支持这个规范就可以了</li>
<li>那这样的话，程序员就只需要学习jdbc这一套规范即可</li>
</ul>
</li>
</ul>
<h4 id="3-jdbc的快速入门程序"><a href="#3-jdbc的快速入门程序" class="headerlink" title="3.jdbc的快速入门程序"></a>3.jdbc的快速入门程序</h4><ol>
<li><p>导入jar包</p>
<figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python">资料中有一个压缩包：mysql-connector-java-<span class="hljs-number">5.1</span><span class="hljs-number">.37</span>.<span class="hljs-built_in">zip</span><br>解压出来，找到mysql-connector-java-<span class="hljs-number">5.1</span><span class="hljs-number">.37</span>-<span class="hljs-built_in">bin</span>.jar<br></code></pre></div></td></tr></table></figure></li>
<li><p>注册驱动</p>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java">Class.forName(<span class="hljs-string">&quot;com.mysql.jdbc.Driver&quot;</span>);<br></code></pre></div></td></tr></table></figure></li>
<li><p>获取连接</p>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java">Connection con = DriverManager.getConnection(<span class="hljs-string">&quot;jdbc:mysql://localhost:3306/db2&quot;</span>, <span class="hljs-string">&quot;root&quot;</span>, <span class="hljs-string">&quot;root&quot;</span>);<br></code></pre></div></td></tr></table></figure></li>
<li><p>获取执行者对象</p>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java">Statement stat = con.createStatement();<br></code></pre></div></td></tr></table></figure></li>
<li><p>执行sql语句，并接收返回结果</p>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java">String sql = <span class="hljs-string">&quot;SELECT * FROM user&quot;</span>;<br>ResultSet rs = stat.executeQuery(sql);<br></code></pre></div></td></tr></table></figure></li>
<li><p>处理结果</p>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">while</span>(rs.next()) &#123;<br>    System.out.println(rs.getInt(<span class="hljs-string">&quot;id&quot;</span>) + <span class="hljs-string">&quot;\t&quot;</span> + rs.getString(<span class="hljs-string">&quot;name&quot;</span>));<br>&#125;<br></code></pre></div></td></tr></table></figure></li>
<li><p>释放资源</p>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java">con.close();<br>stat.close();<br>rs.close();<br></code></pre></div></td></tr></table></figure></li>
<li><p>创建一个java项目：JDBC基础</p>
</li>
<li><p>将jar包导入，并添加到引用类库</p>
</li>
<li><p>新建com.itheima01.JDBCDemo01</p>
</li>
</ol>
   <figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.itheima01;<br><br><span class="hljs-keyword">import</span> java.sql.Connection;<br><span class="hljs-keyword">import</span> java.sql.DriverManager;<br><span class="hljs-keyword">import</span> java.sql.ResultSet;<br><span class="hljs-keyword">import</span> java.sql.Statement;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JDBCDemo01</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception</span>&#123;<br>        <span class="hljs-comment">//1.导入jar包</span><br>        <span class="hljs-comment">//2.注册驱动</span><br>        Class.forName(<span class="hljs-string">&quot;com.mysql.jdbc.Driver&quot;</span>);<br><br>        <span class="hljs-comment">//3.获取连接 （连接的数据库名是db2，第二个第三个参数是连接数据库的用户名密码）</span><br>        Connection con = DriverManager.getConnection(<span class="hljs-string">&quot;jdbc:mysql://192.168.59.129:3306/db2&quot;</span>,<span class="hljs-string">&quot;root&quot;</span>,<span class="hljs-string">&quot;itheima&quot;</span>);<br><br>        <span class="hljs-comment">//4.获取执行者对象 （statement：表现，声明，跟程序意思不匹配）</span><br>        Statement stat = con.createStatement();<br><br>        <span class="hljs-comment">//5.执行sql语句，并且接收结果</span><br>        String sql = <span class="hljs-string">&quot;SELECT * FROM user&quot;</span>;<br>        ResultSet rs = stat.executeQuery(sql); <span class="hljs-comment">//execute执行，query：查询，resultset：结果集</span><br><br>        <span class="hljs-comment">//6.处理结果</span><br>        <span class="hljs-keyword">while</span>(rs.next()) &#123;<br>            System.out.println(rs.getInt(<span class="hljs-string">&quot;id&quot;</span>) + <span class="hljs-string">&quot;\t&quot;</span> + rs.getString(<span class="hljs-string">&quot;name&quot;</span>));<br>        &#125;<br><br>        <span class="hljs-comment">//7.释放资源</span><br>        con.close();<br>        stat.close();<br>        con.close();<br>    &#125;<br>&#125;<br><br></code></pre></div></td></tr></table></figure>

<h3 id="二、JDBC各个功能类详解"><a href="#二、JDBC各个功能类详解" class="headerlink" title="二、JDBC各个功能类详解"></a>二、JDBC各个功能类详解</h3><h4 id="1-DriverManager"><a href="#1-DriverManager" class="headerlink" title="1.DriverManager"></a>1.DriverManager</h4><ul>
<li><p>DriverManager：驱动管理对象</p>
<ul>
<li><p>注册驱动(告诉程序该使用哪一个数据库驱动)</p>
<ul>
<li>注册给定的驱动程序：static void registerDriver(Driver driver)  （DriverManager的方法）<ul>
<li>我们在刚刚的入门案例中并没有注册驱动，也成功了，咋回事呢</li>
</ul>
</li>
<li>这是因为我们使用了Class.forName：Class.forName(“com.mysql.jdbc.Driver”)<ul>
<li>我们通过了给forName指定了是mysql的驱动</li>
<li>它会帮助我们注册驱动，如下：</li>
</ul>
</li>
<li>在com.mysql.jdbc.Driver类中存在静态代码块（通过查看源码发现）</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">//这是com.mysql.jdbc.Driver的静态代码块，只要使用这个类，就会执行这段代码</span><br><span class="hljs-comment">//而Class.forName(&quot;com.mysql.jdbc.Driver&quot;)就正好使用到了这个类</span><br><span class="hljs-keyword">static</span> &#123;<br>	<span class="hljs-keyword">try</span> &#123;<br>		java.sql.DriverManager.registerDriver(<span class="hljs-keyword">new</span> Driver());<br>	&#125; <span class="hljs-keyword">catch</span> (SQLException E) &#123;<br>		<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> RuntimeException(<span class="hljs-string">&quot;Can&#x27;t register driver!&quot;</span>);<br>	&#125;<br>&#125;<br></code></pre></div></td></tr></table></figure>

<ul>
<li><p><strong>注意</strong>：我们不需要通过DriverManager调用静态方法registerDriver()，因为只要Driver类被使用，则会执行其静态代码块完成注册驱动</p>
</li>
<li><p>mysql5之后可以省略注册驱动的步骤。在jar包中，存在一个java.sql.Driver配置文件，文件中指定了com.mysql.jdbc.Driver</p>
<p><img src="/2020/05/04/jdbc01/img/%E9%A9%B1%E5%8A%A8%E9%85%8D%E7%BD%AE.png" srcset="/img/loading.gif" lazyload></p>
</li>
<li><p>所以后边我们其实可以省略注册驱动的步骤（可以注释掉上个案例的注册驱动的步骤，也可以查询到数据）</p>
</li>
</ul>
</li>
</ul>
</li>
<li><p>获取数据库连接(获取到数据库的连接并返回连接对象)</p>
<ul>
<li>static Connection getConnection(String url, String user, String password);<ul>
<li>返回值：Connection数据库连接对象</li>
<li>参数<ul>
<li>url：指定连接的路径。语法：<strong>jdbc:mysql://ip地址(域名):端口号/数据库名称</strong></li>
<li>user：用户名</li>
<li>password：密码</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="2-Connection"><a href="#2-Connection" class="headerlink" title="2.Connection"></a>2.Connection</h4><ul>
<li>Connection：数据库连接对象<ul>
<li>获取执行者对象<ul>
<li>获取普通执行者对象：Statement createStatement();</li>
<li>获取预编译执行者对象：PreparedStatement prepareStatement(String sql);</li>
</ul>
</li>
<li>管理事务<ul>
<li>开启事务：setAutoCommit(boolean autoCommit);     参数为false，则开启事务。</li>
<li>提交事务：commit();</li>
<li>回滚事务：rollback();</li>
</ul>
</li>
<li>释放资源<ul>
<li>立即将数据库连接对象释放：void close();</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="3-Statement"><a href="#3-Statement" class="headerlink" title="3.Statement"></a>3.Statement</h4><ul>
<li>Statement：执行sql语句的对象<ul>
<li>执行DML语句：int executeUpdate(String sql);<ul>
<li>返回值int：<strong>返回影响的行数</strong>。</li>
<li>参数sql：可以执行insert、update、delete语句。</li>
</ul>
</li>
<li>执行DQL语句：ResultSet executeQuery(String sql);<ul>
<li>返回值ResultSet：<strong>封装查询的结果</strong>。</li>
<li>参数sql：可以执行select语句。</li>
</ul>
</li>
<li>释放资源<ul>
<li>立即将执行者对象释放：void close();</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="4-ResultSet"><a href="#4-ResultSet" class="headerlink" title="4.ResultSet"></a>4.ResultSet</h4><ul>
<li>ResultSet：结果集对象<ul>
<li>判断结果集中是否还有数据：boolean next();<ul>
<li>有数据返回true，并将索引向下移动一行</li>
<li>没有数据返回false</li>
</ul>
</li>
<li>获取结果集中的数据：XXX getXxx(“列名”);<ul>
<li>XXX代表数据类型(要获取某列数据，这一列的数据类型)</li>
<li>例如：String getString(“name”);          int getInt(“age”);</li>
</ul>
</li>
<li>释放资源<ul>
<li>立即将结果集对象释放：void close();</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="三、JDBC案例student学生表的CRUD"><a href="#三、JDBC案例student学生表的CRUD" class="headerlink" title="三、JDBC案例student学生表的CRUD"></a>三、JDBC案例student学生表的CRUD</h3><h4 id="1-数据准备"><a href="#1-数据准备" class="headerlink" title="1. 数据准备"></a>1. 数据准备</h4><ul>
<li>数据库和数据表</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs mysql">-- 创建db14数据库<br>CREATE DATABASE db14;<br><br>-- 使用db14数据库<br>USE db14;<br><br>-- 创建student表<br>CREATE TABLE student(<br>	sid INT PRIMARY KEY AUTO_INCREMENT,	-- 学生id<br>	NAME VARCHAR(20),					-- 学生姓名<br>	age INT,							-- 学生年龄<br>	birthday DATE						-- 学生生日<br>);<br><br>-- 添加数据<br>INSERT INTO student VALUES (NULL,&#39;张三&#39;,23,&#39;1999-09-23&#39;),(NULL,&#39;李四&#39;,24,&#39;1998-08-10&#39;),(NULL,&#39;王五&#39;,25,&#39;1996-06-06&#39;),(NULL,&#39;赵六&#39;,26,&#39;1994-10-20&#39;);<br></code></pre></div></td></tr></table></figure>

<ul>
<li>实体类<ul>
<li>Student类，<strong>成员变量对应表中的列</strong></li>
<li><strong>注意</strong>：所有的基本数据类型需要使用包装类，以防null值无法赋值</li>
<li>新建com.itheima02.domain.Student  (保存实体类的包名，可以用bean，也可以用domain)</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.itheima02.domain;<br><br><span class="hljs-keyword">import</span> java.util.Date;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Student</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> Integer sid;<br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-keyword">private</span> Integer age;<br>    <span class="hljs-keyword">private</span> Date birthday;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Student</span><span class="hljs-params">()</span> </span>&#123;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Student</span><span class="hljs-params">(Integer sid, String name, Integer age, Date birthday)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.sid = sid;<br>        <span class="hljs-keyword">this</span>.name = name;<br>        <span class="hljs-keyword">this</span>.age = age;<br>        <span class="hljs-keyword">this</span>.birthday = birthday;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Integer <span class="hljs-title">getSid</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> sid;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setSid</span><span class="hljs-params">(Integer sid)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.sid = sid;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getName</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> name;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setName</span><span class="hljs-params">(String name)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.name = name;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Integer <span class="hljs-title">getAge</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> age;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setAge</span><span class="hljs-params">(Integer age)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.age = age;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Date <span class="hljs-title">getBirthday</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> birthday;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setBirthday</span><span class="hljs-params">(Date birthday)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.birthday = birthday;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">toString</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Student&#123;&quot;</span> +<br>                <span class="hljs-string">&quot;sid=&quot;</span> + sid +<br>                <span class="hljs-string">&quot;, name=&#x27;&quot;</span> + name + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +<br>                <span class="hljs-string">&quot;, age=&quot;</span> + age +<br>                <span class="hljs-string">&quot;, birthday=&quot;</span> + birthday +<br>                <span class="hljs-string">&#x27;&#125;&#x27;</span>;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure>

<ul>
<li><p>本案例会使用分层思想，所以需要新建几个包</p>
</li>
<li><p>dao：数据持久层：操作数据库</p>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">//定义dao接口：StudentDao</span><br><span class="hljs-comment">//本案例要处理五个功能，所以dao接口中定义五个抽象方法</span><br><span class="hljs-keyword">package</span> com.itheima02.dao;<br><br><span class="hljs-keyword">import</span> com.itheima02.domain.Student;<br><br><span class="hljs-keyword">import</span> java.util.ArrayList;<br><br><span class="hljs-comment">/*</span><br><span class="hljs-comment">    Dao层接口</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">StudentDao</span> </span>&#123;<br>    <span class="hljs-comment">//查询所有学生信息</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> ArrayList&lt;Student&gt; <span class="hljs-title">findAll</span><span class="hljs-params">()</span></span>;<br><br>    <span class="hljs-comment">//条件查询，根据id获取学生信息</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> Student <span class="hljs-title">findById</span><span class="hljs-params">(Integer id)</span></span>;<br><br>    <span class="hljs-comment">//新增学生信息</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">int</span> <span class="hljs-title">insert</span><span class="hljs-params">(Student stu)</span></span>;<br><br>    <span class="hljs-comment">//修改学生信息</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">int</span> <span class="hljs-title">update</span><span class="hljs-params">(Student stu)</span></span>;<br><br>    <span class="hljs-comment">//删除学生信息</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">int</span> <span class="hljs-title">delete</span><span class="hljs-params">(Integer id)</span></span>;<br>&#125;<br><br></code></pre></div></td></tr></table></figure></li>
<li><p>service：业务层：处理业务逻辑，调用dao</p>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">//定义service接口：StudentService</span><br><span class="hljs-keyword">package</span> com.itheima02.service;<br><br><span class="hljs-keyword">import</span> com.itheima02.domain.Student;<br><br><span class="hljs-keyword">import</span> java.util.ArrayList;<br><br><span class="hljs-comment">/*</span><br><span class="hljs-comment">    Service层接口</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">StudentService</span> </span>&#123;<br>    <span class="hljs-comment">//查询所有学生信息</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> ArrayList&lt;Student&gt; <span class="hljs-title">findAll</span><span class="hljs-params">()</span></span>;<br><br>    <span class="hljs-comment">//条件查询，根据id获取学生信息</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> Student <span class="hljs-title">findById</span><span class="hljs-params">(Integer id)</span></span>;<br><br>    <span class="hljs-comment">//新增学生信息</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">int</span> <span class="hljs-title">insert</span><span class="hljs-params">(Student stu)</span></span>;<br><br>    <span class="hljs-comment">//修改学生信息</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">int</span> <span class="hljs-title">update</span><span class="hljs-params">(Student stu)</span></span>;<br><br>    <span class="hljs-comment">//删除学生信息</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">int</span> <span class="hljs-title">delete</span><span class="hljs-params">(Integer id)</span></span>;<br>&#125;<br><br></code></pre></div></td></tr></table></figure></li>
<li><p>controller：控制层，调用业务层方法，将数据返回给前端界面（不过目前我们这个案例没有与界面结合）</p>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">//定义控制层类：StudentController，提前准备好对应的测试方法</span><br><span class="hljs-keyword">package</span> com.itheima02.controller;<br><br><span class="hljs-keyword">import</span> org.junit.Test;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">StudentController</span> </span>&#123;<br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">        查询所有学生信息</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">findAll</span><span class="hljs-params">()</span> </span>&#123;<br>    &#125;<br><br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">        条件查询，根据id查询学生信息</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">findById</span><span class="hljs-params">()</span> </span>&#123;<br>    &#125;<br><br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">        添加学生信息</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">insert</span><span class="hljs-params">()</span> </span>&#123;<br>    &#125;<br><br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">        修改学生信息</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">update</span><span class="hljs-params">()</span> </span>&#123;<br>    &#125;<br><br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">        删除学生信息</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">delete</span><span class="hljs-params">()</span> </span>&#123;<br>        <br>    &#125;<br>&#125;<br><br></code></pre></div></td></tr></table></figure></li>
</ul>
<h4 id="2-需求一：查询全部（查询所有学生信息）"><a href="#2-需求一：查询全部（查询所有学生信息）" class="headerlink" title="2. 需求一：查询全部（查询所有学生信息）"></a>2. 需求一：查询全部（查询所有学生信息）</h4><ul>
<li>持久层：新建StudentDaoImpl实现StudentDao，并重写所有方法，我们先来处理第一个逻辑：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">/*</span><br><span class="hljs-comment">     查询所有学生信息</span><br><span class="hljs-comment">*/</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> ArrayList&lt;Student&gt; <span class="hljs-title">findAll</span><span class="hljs-params">()</span> </span>&#123;<br>    ArrayList&lt;Student&gt; list = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br>    Connection con = <span class="hljs-keyword">null</span>;<br>    Statement stat = <span class="hljs-keyword">null</span>;<br>    ResultSet rs = <span class="hljs-keyword">null</span>;<br>    <span class="hljs-keyword">try</span>&#123;<br>        <span class="hljs-comment">//1.注册驱动</span><br>        Class.forName(<span class="hljs-string">&quot;com.mysql.jdbc.Driver&quot;</span>);<br><br>        <span class="hljs-comment">//2.获取数据库连接</span><br>        con = DriverManager.getConnection(<span class="hljs-string">&quot;jdbc:mysql://192.168.59.129:3306/db14&quot;</span>, <span class="hljs-string">&quot;root&quot;</span>, <span class="hljs-string">&quot;itheima&quot;</span>);<br><br>        <span class="hljs-comment">//3.获取执行者对象</span><br>        stat = con.createStatement();<br><br>        <span class="hljs-comment">//4.执行sql语句，并且接收返回的结果集</span><br>        String sql = <span class="hljs-string">&quot;SELECT * FROM student&quot;</span>;<br>        rs = stat.executeQuery(sql);<br><br>        <span class="hljs-comment">//5.处理结果集</span><br>        <span class="hljs-keyword">while</span>(rs.next()) &#123;<br>            Integer sid = rs.getInt(<span class="hljs-string">&quot;sid&quot;</span>);<br>            String name = rs.getString(<span class="hljs-string">&quot;name&quot;</span>);<br>            Integer age = rs.getInt(<span class="hljs-string">&quot;age&quot;</span>);<br>            Date birthday = rs.getDate(<span class="hljs-string">&quot;birthday&quot;</span>);<br><br>            <span class="hljs-comment">//封装Student对象</span><br>            Student stu = <span class="hljs-keyword">new</span> Student(sid,name,age,birthday);<br><br>            <span class="hljs-comment">//将student对象保存到集合中</span><br>            list.add(stu);<br>        &#125;<br><br>    &#125; <span class="hljs-keyword">catch</span>(Exception e) &#123;<br>        e.printStackTrace();<br>    &#125; <span class="hljs-keyword">finally</span> &#123;<br>        <span class="hljs-comment">//6.释放资源</span><br>        <span class="hljs-keyword">if</span>(con != <span class="hljs-keyword">null</span>) &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                con.close();<br>            &#125; <span class="hljs-keyword">catch</span> (SQLException e) &#123;<br>                e.printStackTrace();<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-keyword">if</span>(stat != <span class="hljs-keyword">null</span>) &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                stat.close();<br>            &#125; <span class="hljs-keyword">catch</span> (SQLException e) &#123;<br>                e.printStackTrace();<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-keyword">if</span>(rs != <span class="hljs-keyword">null</span>) &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                rs.close();<br>            &#125; <span class="hljs-keyword">catch</span> (SQLException e) &#123;<br>                e.printStackTrace();<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">//将集合对象返回</span><br>    <span class="hljs-keyword">return</span> list;<br>&#125;<br></code></pre></div></td></tr></table></figure>

<ul>
<li>业务层：新建StudentServiceImpl，实现StudentService，重写所有方法，然后先处理第一个逻辑：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">private</span> StudentDao dao = <span class="hljs-keyword">new</span> StudentDaoImpl();<br><span class="hljs-comment">/*</span><br><span class="hljs-comment">    查询所有学生信息</span><br><span class="hljs-comment">*/</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> ArrayList&lt;Student&gt; <span class="hljs-title">findAll</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> dao.findAll();<br>&#125;<br></code></pre></div></td></tr></table></figure>

<ul>
<li>控制层</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">private</span> StudentService service = <span class="hljs-keyword">new</span> StudentServiceImpl();<br><span class="hljs-comment">/*</span><br><span class="hljs-comment">    查询所有学生信息</span><br><span class="hljs-comment">*/</span><br><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">findAll</span><span class="hljs-params">()</span> </span>&#123;<br>    ArrayList&lt;Student&gt; list = service.findAll();<br>    <span class="hljs-keyword">for</span>(Student stu : list) &#123;<br>        System.out.println(stu);<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure>

<h4 id="3-需求二：条件查询（根据id查询学生信息）"><a href="#3-需求二：条件查询（根据id查询学生信息）" class="headerlink" title="3. 需求二：条件查询（根据id查询学生信息）"></a>3. 需求二：条件查询（根据id查询学生信息）</h4><ul>
<li>持久层</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">/*</span><br><span class="hljs-comment">    条件查询，根据id查询学生信息</span><br><span class="hljs-comment">*/</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> Student <span class="hljs-title">findById</span><span class="hljs-params">(Integer id)</span> </span>&#123;<br>    Student stu = <span class="hljs-keyword">new</span> Student();<br>    Connection con = <span class="hljs-keyword">null</span>;<br>    Statement stat = <span class="hljs-keyword">null</span>;<br>    ResultSet rs = <span class="hljs-keyword">null</span>;<br>    <span class="hljs-keyword">try</span>&#123;<br>        <span class="hljs-comment">//1.注册驱动</span><br>        Class.forName(<span class="hljs-string">&quot;com.mysql.jdbc.Driver&quot;</span>);<br><br>        <span class="hljs-comment">//2.获取数据库连接</span><br>        con = DriverManager.getConnection(<span class="hljs-string">&quot;jdbc:mysql://192.168.59.129:3306/db14&quot;</span>, <span class="hljs-string">&quot;root&quot;</span>, <span class="hljs-string">&quot;itheima&quot;</span>);<br><br>        <span class="hljs-comment">//3.获取执行者对象</span><br>        stat = con.createStatement();<br><br>        <span class="hljs-comment">//4.执行sql语句，并且接收返回的结果集</span><br>        String sql = <span class="hljs-string">&quot;SELECT * FROM student WHERE sid=&#x27;&quot;</span>+id+<span class="hljs-string">&quot;&#x27;&quot;</span>;<br>        rs = stat.executeQuery(sql);<br><br>        <span class="hljs-comment">//5.处理结果集</span><br>        <span class="hljs-keyword">while</span>(rs.next()) &#123;<br>            Integer sid = rs.getInt(<span class="hljs-string">&quot;sid&quot;</span>);<br>            String name = rs.getString(<span class="hljs-string">&quot;name&quot;</span>);<br>            Integer age = rs.getInt(<span class="hljs-string">&quot;age&quot;</span>);<br>            Date birthday = rs.getDate(<span class="hljs-string">&quot;birthday&quot;</span>);<br><br>            <span class="hljs-comment">//封装Student对象</span><br>            stu.setSid(sid);<br>            stu.setName(name);<br>            stu.setAge(age);<br>            stu.setBirthday(birthday);<br>        &#125;<br><br>    &#125; <span class="hljs-keyword">catch</span>(Exception e) &#123;<br>        e.printStackTrace();<br>    &#125; <span class="hljs-keyword">finally</span> &#123;<br>        <span class="hljs-comment">//6.释放资源</span><br>        <span class="hljs-keyword">if</span>(con != <span class="hljs-keyword">null</span>) &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                con.close();<br>            &#125; <span class="hljs-keyword">catch</span> (SQLException e) &#123;<br>                e.printStackTrace();<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-keyword">if</span>(stat != <span class="hljs-keyword">null</span>) &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                stat.close();<br>            &#125; <span class="hljs-keyword">catch</span> (SQLException e) &#123;<br>                e.printStackTrace();<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-keyword">if</span>(rs != <span class="hljs-keyword">null</span>) &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                rs.close();<br>            &#125; <span class="hljs-keyword">catch</span> (SQLException e) &#123;<br>                e.printStackTrace();<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">//将对象返回</span><br>    <span class="hljs-keyword">return</span> stu;<br>&#125;<br></code></pre></div></td></tr></table></figure>

<ul>
<li>业务层</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">/*</span><br><span class="hljs-comment">    条件查询，根据id查询学生信息</span><br><span class="hljs-comment">*/</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> Student <span class="hljs-title">findById</span><span class="hljs-params">(Integer id)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> dao.findById(id);<br>&#125;<br></code></pre></div></td></tr></table></figure>

<ul>
<li>控制层</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">/*</span><br><span class="hljs-comment">    条件查询，根据id查询学生信息</span><br><span class="hljs-comment">*/</span><br><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">findById</span><span class="hljs-params">()</span> </span>&#123;<br>    Student stu = service.findById(<span class="hljs-number">3</span>);<br>    System.out.println(stu);<br>&#125;<br></code></pre></div></td></tr></table></figure>

<h4 id="4-需求三：新增数据-（添加学生）"><a href="#4-需求三：新增数据-（添加学生）" class="headerlink" title="4. 需求三：新增数据 （添加学生）"></a>4. 需求三：新增数据 （添加学生）</h4><ul>
<li>持久层</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">/*</span><br><span class="hljs-comment">      添加学生信息</span><br><span class="hljs-comment">*/</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">insert</span><span class="hljs-params">(Student stu)</span> </span>&#123;<br>    Connection con = <span class="hljs-keyword">null</span>;<br>    Statement stat = <span class="hljs-keyword">null</span>;<br>    <span class="hljs-keyword">int</span> result = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">try</span>&#123;<br>        <span class="hljs-comment">//1.注册驱动</span><br>        Class.forName(<span class="hljs-string">&quot;com.mysql.jdbc.Driver&quot;</span>);<br><br>        <span class="hljs-comment">//2.获取数据库连接</span><br>        con = DriverManager.getConnection(<span class="hljs-string">&quot;jdbc:mysql://192.168.59.129:3306/db14&quot;</span>, <span class="hljs-string">&quot;root&quot;</span>, <span class="hljs-string">&quot;itheima&quot;</span>);<br><br>        <span class="hljs-comment">//3.获取执行者对象</span><br>        stat = con.createStatement();<br><br>        <span class="hljs-comment">//4.执行sql语句，并且接收返回的结果集</span><br>        Date d = stu.getBirthday();<br>        SimpleDateFormat sdf = <span class="hljs-keyword">new</span> SimpleDateFormat(<span class="hljs-string">&quot;yyyy-MM-dd&quot;</span>);<br>        String birthday = sdf.format(d);<br>        String sql = <span class="hljs-string">&quot;INSERT INTO student VALUES (&#x27;&quot;</span>+stu.getSid()+<span class="hljs-string">&quot;&#x27;,&#x27;&quot;</span>+stu.getName()+<span class="hljs-string">&quot;&#x27;,&#x27;&quot;</span>+stu.getAge()+<span class="hljs-string">&quot;&#x27;,&#x27;&quot;</span>+birthday+<span class="hljs-string">&quot;&#x27;)&quot;</span>;<br>        result = stat.executeUpdate(sql);<br><br>    &#125; <span class="hljs-keyword">catch</span>(Exception e) &#123;<br>        e.printStackTrace();<br>    &#125; <span class="hljs-keyword">finally</span> &#123;<br>        <span class="hljs-comment">//6.释放资源</span><br>        <span class="hljs-keyword">if</span>(con != <span class="hljs-keyword">null</span>) &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                con.close();<br>            &#125; <span class="hljs-keyword">catch</span> (SQLException e) &#123;<br>                e.printStackTrace();<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-keyword">if</span>(stat != <span class="hljs-keyword">null</span>) &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                stat.close();<br>            &#125; <span class="hljs-keyword">catch</span> (SQLException e) &#123;<br>                e.printStackTrace();<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">//将结果返回</span><br>    <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></div></td></tr></table></figure>

<ul>
<li>业务层</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">/*</span><br><span class="hljs-comment">    新增学生信息</span><br><span class="hljs-comment">*/</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">insert</span><span class="hljs-params">(Student stu)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> dao.insert(stu);<br>&#125;<br></code></pre></div></td></tr></table></figure>

<ul>
<li>控制层</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">/*</span><br><span class="hljs-comment">  	新增学生信息</span><br><span class="hljs-comment">*/</span><br><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">insert</span><span class="hljs-params">()</span> </span>&#123;<br>    Student stu = <span class="hljs-keyword">new</span> Student(<span class="hljs-number">5</span>,<span class="hljs-string">&quot;周七&quot;</span>,<span class="hljs-number">27</span>,<span class="hljs-keyword">new</span> Date());<br>    <span class="hljs-keyword">int</span> result = service.insert(stu);<br>    <span class="hljs-keyword">if</span>(result != <span class="hljs-number">0</span>) &#123;<br>        System.out.println(<span class="hljs-string">&quot;新增成功&quot;</span>);<br>    &#125;<span class="hljs-keyword">else</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;新增失败&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure>

<h4 id="5-需求四：修改数据（修改学生信息）"><a href="#5-需求四：修改数据（修改学生信息）" class="headerlink" title="5. 需求四：修改数据（修改学生信息）"></a>5. 需求四：修改数据（修改学生信息）</h4><ul>
<li>持久层</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">/*</span><br><span class="hljs-comment">    修改学生信息</span><br><span class="hljs-comment">*/</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">update</span><span class="hljs-params">(Student stu)</span> </span>&#123;<br>    Connection con = <span class="hljs-keyword">null</span>;<br>    Statement stat = <span class="hljs-keyword">null</span>;<br>    <span class="hljs-keyword">int</span> result = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">try</span>&#123;<br>        <span class="hljs-comment">//1.注册驱动</span><br>        Class.forName(<span class="hljs-string">&quot;com.mysql.jdbc.Driver&quot;</span>);<br><br>        <span class="hljs-comment">//2.获取数据库连接</span><br>        con = DriverManager.getConnection(<span class="hljs-string">&quot;jdbc:mysql://192.168.59.129:3306/db14&quot;</span>, <span class="hljs-string">&quot;root&quot;</span>, <span class="hljs-string">&quot;itheima&quot;</span>);<br><br>        <span class="hljs-comment">//3.获取执行者对象</span><br>        stat = con.createStatement();<br><br>        <span class="hljs-comment">//4.执行sql语句，并且接收返回的结果集</span><br>        Date d = stu.getBirthday();<br>        SimpleDateFormat sdf = <span class="hljs-keyword">new</span> SimpleDateFormat(<span class="hljs-string">&quot;yyyy-MM-dd&quot;</span>);<br>        String birthday = sdf.format(d);<br>        String sql = <span class="hljs-string">&quot;UPDATE student SET sid=&#x27;&quot;</span>+stu.getSid()+<span class="hljs-string">&quot;&#x27;,name=&#x27;&quot;</span>+stu.getName()+<span class="hljs-string">&quot;&#x27;,age=&#x27;&quot;</span>+stu.getAge()+<span class="hljs-string">&quot;&#x27;,birthday=&#x27;&quot;</span>+birthday+<span class="hljs-string">&quot;&#x27; WHERE sid=&#x27;&quot;</span>+stu.getSid()+<span class="hljs-string">&quot;&#x27;&quot;</span>;<br>        result = stat.executeUpdate(sql);<br><br>    &#125; <span class="hljs-keyword">catch</span>(Exception e) &#123;<br>        e.printStackTrace();<br>    &#125; <span class="hljs-keyword">finally</span> &#123;<br>        <span class="hljs-comment">//6.释放资源</span><br>        <span class="hljs-keyword">if</span>(con != <span class="hljs-keyword">null</span>) &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                con.close();<br>            &#125; <span class="hljs-keyword">catch</span> (SQLException e) &#123;<br>                e.printStackTrace();<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-keyword">if</span>(stat != <span class="hljs-keyword">null</span>) &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                stat.close();<br>            &#125; <span class="hljs-keyword">catch</span> (SQLException e) &#123;<br>                e.printStackTrace();<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">//将结果返回</span><br>    <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></div></td></tr></table></figure>

<ul>
<li>业务层</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">/*</span><br><span class="hljs-comment">    修改学生信息</span><br><span class="hljs-comment">*/</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">update</span><span class="hljs-params">(Student stu)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> dao.update(stu);<br>&#125;<br></code></pre></div></td></tr></table></figure>

<ul>
<li>控制层</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">/*</span><br><span class="hljs-comment">    修改学生信息</span><br><span class="hljs-comment">*/</span><br><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">update</span><span class="hljs-params">()</span> </span>&#123;<br>    Student stu = service.findById(<span class="hljs-number">5</span>);<br>    stu.setName(<span class="hljs-string">&quot;周七七&quot;</span>);<br><br>    <span class="hljs-keyword">int</span> result = service.update(stu);<br>    <span class="hljs-keyword">if</span>(result != <span class="hljs-number">0</span>) &#123;<br>        System.out.println(<span class="hljs-string">&quot;修改成功&quot;</span>);<br>    &#125;<span class="hljs-keyword">else</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;修改失败&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure>

<h4 id="6-需求五：删除数据（删除学生）"><a href="#6-需求五：删除数据（删除学生）" class="headerlink" title="6. 需求五：删除数据（删除学生）"></a>6. 需求五：删除数据（删除学生）</h4><ul>
<li>持久层</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">/*</span><br><span class="hljs-comment">    删除学生信息</span><br><span class="hljs-comment">*/</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">delete</span><span class="hljs-params">(Integer id)</span> </span>&#123;<br>    Connection con = <span class="hljs-keyword">null</span>;<br>    Statement stat = <span class="hljs-keyword">null</span>;<br>    <span class="hljs-keyword">int</span> result = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">try</span>&#123;<br>        <span class="hljs-comment">//1.注册驱动</span><br>        Class.forName(<span class="hljs-string">&quot;com.mysql.jdbc.Driver&quot;</span>);<br><br>        <span class="hljs-comment">//2.获取数据库连接</span><br>        con = DriverManager.getConnection(<span class="hljs-string">&quot;jdbc:mysql://192.168.59.129:3306/db14&quot;</span>, <span class="hljs-string">&quot;root&quot;</span>, <span class="hljs-string">&quot;itheima&quot;</span>);<br><br>        <span class="hljs-comment">//3.获取执行者对象</span><br>        stat = con.createStatement();<br><br>        <span class="hljs-comment">//4.执行sql语句，并且接收返回的结果集</span><br>        String sql = <span class="hljs-string">&quot;DELETE FROM student WHERE sid=&#x27;&quot;</span>+id+<span class="hljs-string">&quot;&#x27;&quot;</span>;<br>        result = stat.executeUpdate(sql);<br><br>    &#125; <span class="hljs-keyword">catch</span>(Exception e) &#123;<br>        e.printStackTrace();<br>    &#125; <span class="hljs-keyword">finally</span> &#123;<br>        <span class="hljs-comment">//6.释放资源</span><br>        <span class="hljs-keyword">if</span>(con != <span class="hljs-keyword">null</span>) &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                con.close();<br>            &#125; <span class="hljs-keyword">catch</span> (SQLException e) &#123;<br>                e.printStackTrace();<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-keyword">if</span>(stat != <span class="hljs-keyword">null</span>) &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                stat.close();<br>            &#125; <span class="hljs-keyword">catch</span> (SQLException e) &#123;<br>                e.printStackTrace();<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">//将结果返回</span><br>    <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></div></td></tr></table></figure>

<ul>
<li>业务层</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">/*</span><br><span class="hljs-comment">    删除学生信息</span><br><span class="hljs-comment">*/</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">delete</span><span class="hljs-params">(Integer id)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> dao.delete(id);<br>&#125;<br></code></pre></div></td></tr></table></figure>

<ul>
<li>控制层</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">/*</span><br><span class="hljs-comment">    删除学生信息</span><br><span class="hljs-comment">*/</span><br><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">delete</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-keyword">int</span> result = service.delete(<span class="hljs-number">5</span>);<br><br>    <span class="hljs-keyword">if</span>(result != <span class="hljs-number">0</span>) &#123;<br>        System.out.println(<span class="hljs-string">&quot;删除成功&quot;</span>);<br>    &#125;<span class="hljs-keyword">else</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;删除失败&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure>

<h3 id="四、JDBC工具类"><a href="#四、JDBC工具类" class="headerlink" title="四、JDBC工具类"></a>四、JDBC工具类</h3><ul>
<li>为啥需要工具类呢？</li>
<li>因为在上个案例中的dao层的代码，很多都是重复的</li>
<li>程序员一但碰到重复代码，就要想办法解决</li>
</ul>
<h4 id="1-工具类的抽取"><a href="#1-工具类的抽取" class="headerlink" title="1.工具类的抽取"></a>1.工具类的抽取</h4><ul>
<li>配置文件(在src下创建config.properties)</li>
</ul>
<figure class="highlight properties"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs properties"><span class="hljs-attr">driverClass</span>=<span class="hljs-string">com.mysql.jdbc.Driver</span><br><span class="hljs-attr">url</span>=<span class="hljs-string">jdbc:mysql://localhost:3306/db14</span><br><span class="hljs-attr">username</span>=<span class="hljs-string">root</span><br><span class="hljs-attr">password</span>=<span class="hljs-string">itheima</span><br></code></pre></div></td></tr></table></figure>

<ul>
<li>工具类：com.itheima02.utils.JDBCUtils</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.itheima02.utils;<br><br><span class="hljs-keyword">import</span> java.io.InputStream;<br><span class="hljs-keyword">import</span> java.sql.*;<br><span class="hljs-keyword">import</span> java.util.Properties;<br><br><span class="hljs-comment">/*</span><br><span class="hljs-comment">    JDBC工具类</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JDBCUtils</span> </span>&#123;<br>    <span class="hljs-comment">//1.私有构造方法</span><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-title">JDBCUtils</span><span class="hljs-params">()</span></span>&#123;&#125;;<br><br>    <span class="hljs-comment">//2.声明配置信息变量</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> String driverClass;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> String url;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> String username;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> String password;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Connection con;<br><br>    <span class="hljs-comment">//3.静态代码块中实现加载配置文件和注册驱动</span><br>    <span class="hljs-keyword">static</span>&#123;<br>        <span class="hljs-keyword">try</span>&#123;<br>            <span class="hljs-comment">//通过类加载器返回配置文件的字节流</span><br>            InputStream is = JDBCUtils.class.getClassLoader().getResourceAsStream(<span class="hljs-string">&quot;config.properties&quot;</span>);<br><br>            <span class="hljs-comment">//创建Properties集合，加载流对象的信息</span><br>            Properties prop = <span class="hljs-keyword">new</span> Properties();<br>            prop.load(is);<br><br>            <span class="hljs-comment">//获取信息为变量赋值</span><br>            driverClass = prop.getProperty(<span class="hljs-string">&quot;driverClass&quot;</span>);<br>            url = prop.getProperty(<span class="hljs-string">&quot;url&quot;</span>);<br>            username = prop.getProperty(<span class="hljs-string">&quot;username&quot;</span>);<br>            password = prop.getProperty(<span class="hljs-string">&quot;password&quot;</span>);<br><br>            <span class="hljs-comment">//注册驱动</span><br>            Class.forName(driverClass);<br><br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">//4.获取数据库连接的方法</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Connection <span class="hljs-title">getConnection</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            con = DriverManager.getConnection(url,username,password);<br>        &#125; <span class="hljs-keyword">catch</span> (SQLException e) &#123;<br>            e.printStackTrace();<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> con;<br>    &#125;<br><br>    <span class="hljs-comment">//5.释放资源的方法</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">close</span><span class="hljs-params">(Connection con, Statement stat, ResultSet rs)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span>(con != <span class="hljs-keyword">null</span>) &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                con.close();<br>            &#125; <span class="hljs-keyword">catch</span> (SQLException e) &#123;<br>                e.printStackTrace();<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-keyword">if</span>(stat != <span class="hljs-keyword">null</span>) &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                stat.close();<br>            &#125; <span class="hljs-keyword">catch</span> (SQLException e) &#123;<br>                e.printStackTrace();<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-keyword">if</span>(rs != <span class="hljs-keyword">null</span>) &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                rs.close();<br>            &#125; <span class="hljs-keyword">catch</span> (SQLException e) &#123;<br>                e.printStackTrace();<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">close</span><span class="hljs-params">(Connection con, Statement stat)</span> </span>&#123;<br>        close(con,stat,<span class="hljs-keyword">null</span>);<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure>

<h4 id="2-使用工具类优化student表的CRUD"><a href="#2-使用工具类优化student表的CRUD" class="headerlink" title="2.使用工具类优化student表的CRUD"></a>2.使用工具类优化student表的CRUD</h4><ul>
<li>查询全部：修改StudentDaoImpl 中的方法</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">/*</span><br><span class="hljs-comment">    查询所有学生信息</span><br><span class="hljs-comment">*/</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> ArrayList&lt;Student&gt; <span class="hljs-title">findAll</span><span class="hljs-params">()</span> </span>&#123;<br>    ArrayList&lt;Student&gt; list = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br>    Connection con = <span class="hljs-keyword">null</span>;<br>    Statement stat = <span class="hljs-keyword">null</span>;<br>    ResultSet rs = <span class="hljs-keyword">null</span>;<br>    <span class="hljs-keyword">try</span>&#123;<br><br>        con = JDBCUtils.getConnection();<br><br>        <span class="hljs-comment">//3.获取执行者对象</span><br>        stat = con.createStatement();<br><br>        <span class="hljs-comment">//4.执行sql语句，并且接收返回的结果集</span><br>        String sql = <span class="hljs-string">&quot;SELECT * FROM student&quot;</span>;<br>        rs = stat.executeQuery(sql);<br><br>        <span class="hljs-comment">//5.处理结果集</span><br>        <span class="hljs-keyword">while</span>(rs.next()) &#123;<br>            Integer sid = rs.getInt(<span class="hljs-string">&quot;sid&quot;</span>);<br>            String name = rs.getString(<span class="hljs-string">&quot;name&quot;</span>);<br>            Integer age = rs.getInt(<span class="hljs-string">&quot;age&quot;</span>);<br>            Date birthday = rs.getDate(<span class="hljs-string">&quot;birthday&quot;</span>);<br><br>            <span class="hljs-comment">//封装Student对象</span><br>            Student stu = <span class="hljs-keyword">new</span> Student(sid,name,age,birthday);<br><br>            <span class="hljs-comment">//将student对象保存到集合中</span><br>            list.add(stu);<br>        &#125;<br><br>    &#125; <span class="hljs-keyword">catch</span>(Exception e) &#123;<br>        e.printStackTrace();<br>    &#125; <span class="hljs-keyword">finally</span> &#123;<br>        <span class="hljs-comment">//6.释放资源</span><br>        JDBCUtils.close(con,stat,rs);<br>    &#125;<br>    <span class="hljs-comment">//将集合对象返回</span><br>    <span class="hljs-keyword">return</span> list;<br>&#125;<br></code></pre></div></td></tr></table></figure>

<ul>
<li>条件查询</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">/*</span><br><span class="hljs-comment">    条件查询，根据id查询学生信息</span><br><span class="hljs-comment">*/</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> Student <span class="hljs-title">findById</span><span class="hljs-params">(Integer id)</span> </span>&#123;<br>    Student stu = <span class="hljs-keyword">new</span> Student();<br>    Connection con = <span class="hljs-keyword">null</span>;<br>    Statement stat = <span class="hljs-keyword">null</span>;<br>    ResultSet rs = <span class="hljs-keyword">null</span>;<br>    <span class="hljs-keyword">try</span>&#123;<br><br>        con = JDBCUtils.getConnection();<br><br>        <span class="hljs-comment">//3.获取执行者对象</span><br>        stat = con.createStatement();<br><br>        <span class="hljs-comment">//4.执行sql语句，并且接收返回的结果集</span><br>        String sql = <span class="hljs-string">&quot;SELECT * FROM student WHERE sid=&#x27;&quot;</span>+id+<span class="hljs-string">&quot;&#x27;&quot;</span>;<br>        rs = stat.executeQuery(sql);<br><br>        <span class="hljs-comment">//5.处理结果集</span><br>        <span class="hljs-keyword">while</span>(rs.next()) &#123;<br>            Integer sid = rs.getInt(<span class="hljs-string">&quot;sid&quot;</span>);<br>            String name = rs.getString(<span class="hljs-string">&quot;name&quot;</span>);<br>            Integer age = rs.getInt(<span class="hljs-string">&quot;age&quot;</span>);<br>            Date birthday = rs.getDate(<span class="hljs-string">&quot;birthday&quot;</span>);<br><br>            <span class="hljs-comment">//封装Student对象</span><br>            stu.setSid(sid);<br>            stu.setName(name);<br>            stu.setAge(age);<br>            stu.setBirthday(birthday);<br>        &#125;<br><br>    &#125; <span class="hljs-keyword">catch</span>(Exception e) &#123;<br>        e.printStackTrace();<br>    &#125; <span class="hljs-keyword">finally</span> &#123;<br>        <span class="hljs-comment">//6.释放资源</span><br>        JDBCUtils.close(con,stat,rs);<br>    &#125;<br>    <span class="hljs-comment">//将对象返回</span><br>    <span class="hljs-keyword">return</span> stu;<br>&#125;<br></code></pre></div></td></tr></table></figure>

<ul>
<li>新增数据</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">/*</span><br><span class="hljs-comment">     添加学生信息</span><br><span class="hljs-comment">*/</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">insert</span><span class="hljs-params">(Student stu)</span> </span>&#123;<br>    Connection con = <span class="hljs-keyword">null</span>;<br>    Statement stat = <span class="hljs-keyword">null</span>;<br>    <span class="hljs-keyword">int</span> result = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">try</span>&#123;<br>        con = JDBCUtils.getConnection();<br><br>        <span class="hljs-comment">//3.获取执行者对象</span><br>        stat = con.createStatement();<br><br>        <span class="hljs-comment">//4.执行sql语句，并且接收返回的结果集</span><br>        Date d = stu.getBirthday();<br>        SimpleDateFormat sdf = <span class="hljs-keyword">new</span> SimpleDateFormat(<span class="hljs-string">&quot;yyyy-MM-dd&quot;</span>);<br>        String birthday = sdf.format(d);<br>        String sql = <span class="hljs-string">&quot;INSERT INTO student VALUES (&#x27;&quot;</span>+stu.getSid()+<span class="hljs-string">&quot;&#x27;,&#x27;&quot;</span>+stu.getName()+<span class="hljs-string">&quot;&#x27;,&#x27;&quot;</span>+stu.getAge()+<span class="hljs-string">&quot;&#x27;,&#x27;&quot;</span>+birthday+<span class="hljs-string">&quot;&#x27;)&quot;</span>;<br>        result = stat.executeUpdate(sql);<br><br>    &#125; <span class="hljs-keyword">catch</span>(Exception e) &#123;<br>        e.printStackTrace();<br>    &#125; <span class="hljs-keyword">finally</span> &#123;<br>        <span class="hljs-comment">//6.释放资源</span><br>        JDBCUtils.close(con,stat);<br>    &#125;<br>    <span class="hljs-comment">//将结果返回</span><br>    <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></div></td></tr></table></figure>

<ul>
<li>修改数据</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">/*</span><br><span class="hljs-comment">     修改学生信息</span><br><span class="hljs-comment">*/</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">update</span><span class="hljs-params">(Student stu)</span> </span>&#123;<br>    Connection con = <span class="hljs-keyword">null</span>;<br>    Statement stat = <span class="hljs-keyword">null</span>;<br>    <span class="hljs-keyword">int</span> result = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">try</span>&#123;<br>        con = JDBCUtils.getConnection();<br><br>        <span class="hljs-comment">//3.获取执行者对象</span><br>        stat = con.createStatement();<br><br>        <span class="hljs-comment">//4.执行sql语句，并且接收返回的结果集</span><br>        Date d = stu.getBirthday();<br>        SimpleDateFormat sdf = <span class="hljs-keyword">new</span> SimpleDateFormat(<span class="hljs-string">&quot;yyyy-MM-dd&quot;</span>);<br>        String birthday = sdf.format(d);<br>        String sql = <span class="hljs-string">&quot;UPDATE student SET sid=&#x27;&quot;</span>+stu.getSid()+<span class="hljs-string">&quot;&#x27;,name=&#x27;&quot;</span>+stu.getName()+<span class="hljs-string">&quot;&#x27;,age=&#x27;&quot;</span>+stu.getAge()+<span class="hljs-string">&quot;&#x27;,birthday=&#x27;&quot;</span>+birthday+<span class="hljs-string">&quot;&#x27; WHERE sid=&#x27;&quot;</span>+stu.getSid()+<span class="hljs-string">&quot;&#x27;&quot;</span>;<br>        result = stat.executeUpdate(sql);<br><br>    &#125; <span class="hljs-keyword">catch</span>(Exception e) &#123;<br>        e.printStackTrace();<br>    &#125; <span class="hljs-keyword">finally</span> &#123;<br>        <span class="hljs-comment">//6.释放资源</span><br>        JDBCUtils.close(con,stat);<br>    &#125;<br>    <span class="hljs-comment">//将结果返回</span><br>    <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></div></td></tr></table></figure>

<ul>
<li>删除数据</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">/*</span><br><span class="hljs-comment">   删除学生信息</span><br><span class="hljs-comment">*/</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">delete</span><span class="hljs-params">(Integer id)</span> </span>&#123;<br>    Connection con = <span class="hljs-keyword">null</span>;<br>    Statement stat = <span class="hljs-keyword">null</span>;<br>    <span class="hljs-keyword">int</span> result = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">try</span>&#123;<br>        con = JDBCUtils.getConnection();<br><br>        <span class="hljs-comment">//3.获取执行者对象</span><br>        stat = con.createStatement();<br><br>        <span class="hljs-comment">//4.执行sql语句，并且接收返回的结果集</span><br>        String sql = <span class="hljs-string">&quot;DELETE FROM student WHERE sid=&#x27;&quot;</span>+id+<span class="hljs-string">&quot;&#x27;&quot;</span>;<br>        result = stat.executeUpdate(sql);<br><br>    &#125; <span class="hljs-keyword">catch</span>(Exception e) &#123;<br>        e.printStackTrace();<br>    &#125; <span class="hljs-keyword">finally</span> &#123;<br>        <span class="hljs-comment">//6.释放资源</span><br>        JDBCUtils.close(con,stat);<br>    &#125;<br>    <span class="hljs-comment">//将结果返回</span><br>    <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></div></td></tr></table></figure>

<h4 id="3-student表的CRUD整合页面"><a href="#3-student表的CRUD整合页面" class="headerlink" title="3.student表的CRUD整合页面"></a>3.student表的CRUD整合页面</h4><ul>
<li><p>接下来我们将程序与界面结合起来</p>
</li>
<li><p>用户表的数据准备</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs mysql">-- 创建用户表<br>CREATE TABLE USER(<br>	uid VARCHAR(50) PRIMARY KEY,	-- 用户id<br>	ucode VARCHAR(50),				-- 用户标识<br>	loginname VARCHAR(100),			-- 登录用户名<br>	PASSWORD VARCHAR(100),			-- 登录密码<br>	username VARCHAR(100),			-- 用户名<br>	gender VARCHAR(10),				-- 用户性别<br>	birthday DATE,					-- 出生日期<br>	dutydate DATE                   -- 入职日期<br>);<br>-- 添加一条测试数据<br>INSERT INTO &#96;user&#96; VALUES (&#39;11111111&#39;, &#39;zhangsan001&#39;, &#39;zhangsan&#39;, &#39;1234&#39;, &#39;张三&#39;, &#39;男&#39;, &#39;2008-10-28&#39;, &#39;2018-10-28&#39;);<br></code></pre></div></td></tr></table></figure>

<ul>
<li>今天资料中有一个准备好的项目：JDBC基础网页版</li>
<li>将上个案例的StudentDaoImpl复制到这个案例中，需要修改insert方法中的id为null，因为id是自增的</li>
<li>或者直接复制如下代码：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">StudentDaoImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">StudentDao</span> </span>&#123;<br><br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">        查询所有学生信息</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> ArrayList&lt;Student&gt; <span class="hljs-title">findAll</span><span class="hljs-params">()</span> </span>&#123;<br>        Connection con = <span class="hljs-keyword">null</span>;<br>        Statement stat = <span class="hljs-keyword">null</span>;<br>        ResultSet rs = <span class="hljs-keyword">null</span>;<br>        ArrayList&lt;Student&gt; list = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">//1.获取连接</span><br>            con = JDBCUtils.getConnection();<br><br>            <span class="hljs-comment">//2.获取执行者对象</span><br>            stat = con.createStatement();<br><br>            <span class="hljs-comment">//3.执行sql语句，并接收结果</span><br>            String sql = <span class="hljs-string">&quot;SELECT * FROM student&quot;</span>;<br>            rs = stat.executeQuery(sql);<br><br>            <span class="hljs-comment">//4.处理结果，将每条记录封装成一个Student对象。将多个Student对象保存到集合中</span><br>            <span class="hljs-keyword">while</span>(rs.next()) &#123;<br>                Integer sid = rs.getInt(<span class="hljs-string">&quot;sid&quot;</span>);<br>                String name = rs.getString(<span class="hljs-string">&quot;name&quot;</span>);<br>                Integer age = rs.getInt(<span class="hljs-string">&quot;age&quot;</span>);<br>                Date birthday = rs.getDate(<span class="hljs-string">&quot;birthday&quot;</span>);<br><br>                Student stu = <span class="hljs-keyword">new</span> Student(sid,name,age,birthday);<br><br>                list.add(stu);<br>            &#125;<br><br>        &#125; <span class="hljs-keyword">catch</span> (SQLException e) &#123;<br>            e.printStackTrace();<br>        &#125; <span class="hljs-keyword">finally</span> &#123;<br>            <span class="hljs-comment">//5.释放资源</span><br>            JDBCUtils.close(con,stat,rs);<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> list;<br>    &#125;<br><br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">        条件查询，根据id查询学生信息</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Student <span class="hljs-title">findById</span><span class="hljs-params">(Integer id)</span> </span>&#123;<br>        Connection con = <span class="hljs-keyword">null</span>;<br>        Statement stat = <span class="hljs-keyword">null</span>;<br>        ResultSet rs = <span class="hljs-keyword">null</span>;<br>        Student stu = <span class="hljs-keyword">new</span> Student();<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">//1.获取连接</span><br>            con = JDBCUtils.getConnection();<br><br>            <span class="hljs-comment">//2.获取执行者对象</span><br>            stat = con.createStatement();<br><br>            <span class="hljs-comment">//3.执行sql语句，并接收结果</span><br>            String sql = <span class="hljs-string">&quot;SELECT * FROM student WHERE sid=&#x27;&quot;</span>+id+<span class="hljs-string">&quot;&#x27;&quot;</span>;<br>            rs = stat.executeQuery(sql);<br><br>            <span class="hljs-comment">//4.处理结果，将记录封装成一个Student对象。</span><br>            <span class="hljs-keyword">if</span>(rs.next()) &#123;<br>                Integer sid = rs.getInt(<span class="hljs-string">&quot;sid&quot;</span>);<br>                String name = rs.getString(<span class="hljs-string">&quot;name&quot;</span>);<br>                Integer age = rs.getInt(<span class="hljs-string">&quot;age&quot;</span>);<br>                Date birthday = rs.getDate(<span class="hljs-string">&quot;birthday&quot;</span>);<br><br>                stu.setSid(sid);<br>                stu.setName(name);<br>                stu.setAge(age);<br>                stu.setBirthday(birthday);<br>            &#125;<br><br>        &#125; <span class="hljs-keyword">catch</span> (SQLException e) &#123;<br>            e.printStackTrace();<br>        &#125; <span class="hljs-keyword">finally</span> &#123;<br>            <span class="hljs-comment">//5.释放资源</span><br>            JDBCUtils.close(con,stat,rs);<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> stu;<br>    &#125;<br><br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">        新增学生信息</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">insert</span><span class="hljs-params">(Student stu)</span> </span>&#123;<br>        Connection con = <span class="hljs-keyword">null</span>;<br>        Statement stat = <span class="hljs-keyword">null</span>;<br>        <span class="hljs-keyword">int</span> result = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">try</span>&#123;<br>            <span class="hljs-comment">//1.获取连接</span><br>            con = JDBCUtils.getConnection();<br><br>            <span class="hljs-comment">//2.获取执行者对象</span><br>            stat = con.createStatement();<br><br>            <span class="hljs-comment">//3.执行sql语句，并接收结果</span><br>            Date date = stu.getBirthday();<br>            SimpleDateFormat sdf = <span class="hljs-keyword">new</span> SimpleDateFormat(<span class="hljs-string">&quot;yyyy-MM-dd&quot;</span>);<br>            String birthday = sdf.format(date);<br>            String sql = <span class="hljs-string">&quot;INSERT INTO student VALUES (null,&#x27;&quot;</span>+stu.getName()+<span class="hljs-string">&quot;&#x27;,&#x27;&quot;</span>+stu.getAge()+<span class="hljs-string">&quot;&#x27;,&#x27;&quot;</span>+birthday+<span class="hljs-string">&quot;&#x27;)&quot;</span>;<br>            result = stat.executeUpdate(sql);<br><br>        &#125; <span class="hljs-keyword">catch</span> (SQLException e) &#123;<br>            e.printStackTrace();<br>        &#125; <span class="hljs-keyword">finally</span> &#123;<br>            <span class="hljs-comment">//4.释放资源</span><br>            JDBCUtils.close(con,stat);<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> result;<br>    &#125;<br><br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">        修改学生信息</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">update</span><span class="hljs-params">(Student stu)</span> </span>&#123;<br>        Connection con = <span class="hljs-keyword">null</span>;<br>        Statement stat = <span class="hljs-keyword">null</span>;<br>        <span class="hljs-keyword">int</span> result = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">try</span>&#123;<br>            <span class="hljs-comment">//1.获取连接</span><br>            con = JDBCUtils.getConnection();<br><br>            <span class="hljs-comment">//2.获取执行者对象</span><br>            stat = con.createStatement();<br><br>            <span class="hljs-comment">//3.执行sql语句，并接收结果</span><br>            Date date = stu.getBirthday();<br>            SimpleDateFormat sdf = <span class="hljs-keyword">new</span> SimpleDateFormat(<span class="hljs-string">&quot;yyyy-MM-dd&quot;</span>);<br>            String birthday = sdf.format(date);<br>            String sql = <span class="hljs-string">&quot;UPDATE student SET sid=&#x27;&quot;</span>+stu.getSid()+<span class="hljs-string">&quot;&#x27;,name=&#x27;&quot;</span>+stu.getName()+<span class="hljs-string">&quot;&#x27;,age=&#x27;&quot;</span>+stu.getAge()+<span class="hljs-string">&quot;&#x27;,birthday=&#x27;&quot;</span>+birthday+<span class="hljs-string">&quot;&#x27; WHERE sid=&#x27;&quot;</span>+stu.getSid()+<span class="hljs-string">&quot;&#x27;&quot;</span>;<br>            result = stat.executeUpdate(sql);<br><br>        &#125; <span class="hljs-keyword">catch</span> (SQLException e) &#123;<br>            e.printStackTrace();<br>        &#125; <span class="hljs-keyword">finally</span> &#123;<br>            <span class="hljs-comment">//4.释放资源</span><br>            JDBCUtils.close(con,stat);<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> result;<br>    &#125;<br><br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">        删除学生信息</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">delete</span><span class="hljs-params">(Integer id)</span> </span>&#123;<br>        Connection con = <span class="hljs-keyword">null</span>;<br>        Statement stat = <span class="hljs-keyword">null</span>;<br>        <span class="hljs-keyword">int</span> result = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">try</span>&#123;<br>            <span class="hljs-comment">//1.获取连接</span><br>            con = JDBCUtils.getConnection();<br><br>            <span class="hljs-comment">//2.获取执行者对象</span><br>            stat = con.createStatement();<br><br>            <span class="hljs-comment">//3.执行sql语句，并接收结果</span><br>            String sql = <span class="hljs-string">&quot;DELETE FROM student WHERE sid=&#x27;&quot;</span>+id+<span class="hljs-string">&quot;&#x27;&quot;</span>;<br>            result = stat.executeUpdate(sql);<br><br>        &#125; <span class="hljs-keyword">catch</span> (SQLException e) &#123;<br>            e.printStackTrace();<br>        &#125;  <span class="hljs-keyword">finally</span> &#123;<br>            <span class="hljs-comment">//4.释放资源</span><br>            JDBCUtils.close(con,stat);<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> result;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure>

<ul>
<li><p>测试：用户名zhangsan，密码1234</p>
<p><img src="/2020/05/04/jdbc01/img/login.png" srcset="/img/loading.gif" lazyload></p>
</li>
<li><p>找到学生管理</p>
<p><img src="/2020/05/04/jdbc01/img/%E5%AD%A6%E7%94%9F%E7%AE%A1%E7%90%86.png" srcset="/img/loading.gif" lazyload></p>
</li>
<li><p>然后可以添加，修改，删除</p>
</li>
<li><p>那至于，界面和相关Servlet代码，咱们先不用管，后边会有类似的案例</p>
</li>
</ul>
<h3 id="五、SQL注入攻击"><a href="#五、SQL注入攻击" class="headerlink" title="五、SQL注入攻击"></a>五、SQL注入攻击</h3><h4 id="1-sql注入攻击的演示"><a href="#1-sql注入攻击的演示" class="headerlink" title="1.sql注入攻击的演示"></a>1.sql注入攻击的演示</h4><ul>
<li>sql注入攻击：就是利用sql语句的漏洞来对系统进行攻击</li>
<li>演示：<ul>
<li>在登录界面，输入一个错误的用户名或密码，也可以登录成功</li>
</ul>
</li>
</ul>
<p><img src="/2020/05/04/jdbc01/JDBC-01-%E6%8E%88%E8%AF%BE%E7%AC%94%E8%AE%B0.assets/06.png" srcset="/img/loading.gif" lazyload alt="06"></p>
<ul>
<li><p>分析：为啥能够登陆成功？</p>
<ul>
<li>登陆的时候，会调用UserDaoImpl .findByLoginNameAndPassword 方法</li>
<li>此方法中的sql语句如下</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">//2.定义SQL语句</span><br>String sql = <span class="hljs-string">&quot;SELECT * FROM user WHERE loginname=&#x27;&quot;</span>+loginName+<span class="hljs-string">&quot;&#x27; AND password=&#x27;&quot;</span>+password+<span class="hljs-string">&quot;&#x27;&quot;</span>;<br>System.out.println(sql);<br><span class="hljs-comment">//3.获取操作对象，执行sql语句，获取结果集</span><br>st = conn.createStatement();<br>rs = st.executeQuery(sql);<br><span class="hljs-comment">//4.获取结果集</span><br><span class="hljs-keyword">if</span> (rs.next()) &#123;<br>    <span class="hljs-comment">//5.封装</span><br>    user = <span class="hljs-keyword">new</span> User();<br>    user.setUid(rs.getString(<span class="hljs-string">&quot;uid&quot;</span>));<br>    ....<br>&#125;<br><span class="hljs-comment">//6.返回</span><br><span class="hljs-keyword">return</span> user;<br></code></pre></div></td></tr></table></figure>

<ul>
<li><p>输入aaa和aaa’ or ‘1’=’1 (注意引号)最终sql拼接完变为：</p>
<figure class="highlight sql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">WHERE</span> loginname<span class="hljs-operator">=</span><span class="hljs-string">&#x27;aaa&#x27;</span> <span class="hljs-keyword">AND</span> password<span class="hljs-operator">=</span><span class="hljs-string">&#x27;aaa&#x27;</span> <span class="hljs-keyword">or</span> <span class="hljs-string">&#x27;1&#x27;</span><span class="hljs-operator">=</span><span class="hljs-string">&#x27;1&#x27;</span><br></code></pre></div></td></tr></table></figure></li>
<li><p>这样的sql语句，会将user表中所有数据都查询出来（当然我们目前user中只有zhangsan一条数据）</p>
</li>
<li><p>所以最终查询到用户了，就登陆进去了</p>
</li>
</ul>
</li>
</ul>
<h4 id="2-sql注入攻击的原理"><a href="#2-sql注入攻击的原理" class="headerlink" title="2.sql注入攻击的原理"></a>2.sql注入攻击的原理</h4><ul>
<li>按照正常道理来说，我们在密码处输入的所有内容，都应该认为是密码的组成</li>
<li>但是现在Statement对象在执行sql语句时，将一部分内容当做查询条件来执行了</li>
</ul>
<h4 id="3-PreparedStatement的介绍"><a href="#3-PreparedStatement的介绍" class="headerlink" title="3.PreparedStatement的介绍"></a>3.PreparedStatement的介绍</h4><ul>
<li>预编译sql语句的执行者对象。在执行sql语句之前，将sql语句进行提前编译</li>
<li>明确sql语句的格式后，就不会改变了。剩余的内容都会认为是参数</li>
<li>参数使用?作为占位符</li>
<li>为参数赋值的方法：setXxx(参数1,参数2);<ul>
<li>参数1：?的位置编号(编号从1开始)</li>
<li>参数2：?的实际参数</li>
</ul>
</li>
<li>执行sql语句的方法<ul>
<li>执行insert、update、delete语句：int executeUpdate();</li>
<li>执行select语句：ResultSet executeQuery();</li>
</ul>
</li>
</ul>
<h4 id="4-PreparedStatement的使用"><a href="#4-PreparedStatement的使用" class="headerlink" title="4.PreparedStatement的使用"></a>4.PreparedStatement的使用</h4><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">/*</span><br><span class="hljs-comment">	 使用PreparedStatement的登录方法，解决注入攻击</span><br><span class="hljs-comment">*/</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> User <span class="hljs-title">findByLoginNameAndPassword</span><span class="hljs-params">(String loginName, String password)</span> </span>&#123;<br>    <span class="hljs-comment">//定义必要信息</span><br>    Connection conn = <span class="hljs-keyword">null</span>;<br>    PreparedStatement pstm = <span class="hljs-keyword">null</span>;<br>    ResultSet rs = <span class="hljs-keyword">null</span>;<br>    User user = <span class="hljs-keyword">null</span>;<br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-comment">//1.获取连接</span><br>        conn = JDBCUtils.getConnection();<br>        <span class="hljs-comment">//2.创建操作SQL对象</span><br>        String sql = <span class="hljs-string">&quot;SELECT * FROM user WHERE loginname=? AND password=?&quot;</span>;<br>        pstm = conn.prepareStatement(sql);<br>        <span class="hljs-comment">//3.设置参数</span><br>        pstm.setString(<span class="hljs-number">1</span>,loginName);<span class="hljs-comment">//设置第一个?参数</span><br>        pstm.setString(<span class="hljs-number">2</span>,password);<span class="hljs-comment">//设置第二个?参数</span><br>        System.out.println(sql);<br>        <span class="hljs-comment">//4.执行sql语句，获取结果集</span><br>        rs = pstm.executeQuery();<br>        <span class="hljs-comment">//5.获取结果集</span><br>        <span class="hljs-keyword">if</span> (rs.next()) &#123;<br>            <span class="hljs-comment">//6.封装</span><br>            user = <span class="hljs-keyword">new</span> User();<br>            user.setUid(rs.getString(<span class="hljs-string">&quot;uid&quot;</span>));<br>            user.setUcode(rs.getString(<span class="hljs-string">&quot;ucode&quot;</span>));<br>            user.setUsername(rs.getString(<span class="hljs-string">&quot;username&quot;</span>));<br>            user.setPassword(rs.getString(<span class="hljs-string">&quot;password&quot;</span>));<br>            user.setGender(rs.getString(<span class="hljs-string">&quot;gender&quot;</span>));<br>            user.setDutydate(rs.getDate(<span class="hljs-string">&quot;dutydate&quot;</span>));<br>            user.setBirthday(rs.getDate(<span class="hljs-string">&quot;birthday&quot;</span>));<br>            user.setLoginname(rs.getString(<span class="hljs-string">&quot;loginname&quot;</span>));<br>        &#125;<br>        <span class="hljs-comment">//7.返回</span><br>        <span class="hljs-keyword">return</span> user;<br>    &#125;<span class="hljs-keyword">catch</span> (Exception e)&#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> RuntimeException(e);<br>    &#125;<span class="hljs-keyword">finally</span> &#123;<br>        JDBCUtils.close(conn,pstm,rs);<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure>

<h4 id="5-使用PreparedStatement优化student表的CRUD（作业）"><a href="#5-使用PreparedStatement优化student表的CRUD（作业）" class="headerlink" title="5.使用PreparedStatement优化student表的CRUD（作业）"></a>5.使用PreparedStatement优化student表的CRUD（作业）</h4><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">StudentDaoImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">StudentDao</span> </span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> ArrayList&lt;Student&gt; <span class="hljs-title">findAll</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-comment">//定义必要信息</span><br>        Connection conn = <span class="hljs-keyword">null</span>;<br>        PreparedStatement pstm = <span class="hljs-keyword">null</span>;<br>        ResultSet rs = <span class="hljs-keyword">null</span>;<br>        ArrayList&lt;Student&gt; students = <span class="hljs-keyword">null</span>;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">//1.获取连接</span><br>            conn = JDBCUtils.getConnection();<br>            <span class="hljs-comment">//2.获取操作对象</span><br>            pstm = conn.prepareStatement(<span class="hljs-string">&quot;select * from student&quot;</span>);<br>            <span class="hljs-comment">//3.执行sql语句，获取结果集</span><br>            rs = pstm.executeQuery();<br>            <span class="hljs-comment">//4.遍历结果集</span><br>            students = <span class="hljs-keyword">new</span> ArrayList&lt;Student&gt;();<br>            <span class="hljs-keyword">while</span> (rs.next()) &#123;<br>                <span class="hljs-comment">//5.封装</span><br>                Student student = <span class="hljs-keyword">new</span> Student();<br>                student.setSid(rs.getInt(<span class="hljs-string">&quot;sid&quot;</span>));<br>                student.setName(rs.getString(<span class="hljs-string">&quot;name&quot;</span>));<br>                student.setAge(rs.getInt(<span class="hljs-string">&quot;age&quot;</span>));<br>                student.setBirthday(rs.getDate(<span class="hljs-string">&quot;birthday&quot;</span>));<br>                <span class="hljs-comment">//加入到集合中</span><br>                students.add(student);<br>            &#125;<br>            <span class="hljs-comment">//6.返回</span><br>            <span class="hljs-keyword">return</span> students;<br>        &#125;<span class="hljs-keyword">catch</span> (Exception e)&#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> RuntimeException(e);<br>        &#125;<span class="hljs-keyword">finally</span> &#123;<br>            JDBCUtils.close(conn,pstm,rs);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Student <span class="hljs-title">findById</span><span class="hljs-params">(Integer sid)</span> </span>&#123;<br>        <span class="hljs-comment">//定义必要信息</span><br>        Connection conn = <span class="hljs-keyword">null</span>;<br>        PreparedStatement pstm = <span class="hljs-keyword">null</span>;<br>        ResultSet rs = <span class="hljs-keyword">null</span>;<br>        Student student = <span class="hljs-keyword">null</span>;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">//1.获取连接</span><br>            conn = JDBCUtils.getConnection();<br>            <span class="hljs-comment">//2.获取操作对象</span><br>            pstm = conn.prepareStatement(<span class="hljs-string">&quot;select * from student where sid = ? &quot;</span>);<br>            pstm.setInt(<span class="hljs-number">1</span>,sid);<br>            <span class="hljs-comment">//3.执行sql语句，获取结果集</span><br>            rs = pstm.executeQuery();<br>            <span class="hljs-comment">//4.遍历结果集</span><br>            <span class="hljs-keyword">if</span> (rs.next()) &#123;<br>                <span class="hljs-comment">//5.封装</span><br>                student = <span class="hljs-keyword">new</span> Student();<br>                student.setSid(rs.getInt(<span class="hljs-string">&quot;sid&quot;</span>));<br>                student.setName(rs.getString(<span class="hljs-string">&quot;name&quot;</span>));<br>                student.setAge(rs.getInt(<span class="hljs-string">&quot;age&quot;</span>));<br>                student.setBirthday(rs.getDate(<span class="hljs-string">&quot;birthday&quot;</span>));<br>            &#125;<br>            <span class="hljs-comment">//6.返回</span><br>            <span class="hljs-keyword">return</span> student;<br>        &#125;<span class="hljs-keyword">catch</span> (Exception e)&#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> RuntimeException(e);<br>        &#125;<span class="hljs-keyword">finally</span> &#123;<br>            JDBCUtils.close(conn,pstm,rs);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">insert</span><span class="hljs-params">(Student student)</span> </span>&#123;<br>        <span class="hljs-comment">//定义必要信息</span><br>        Connection conn = <span class="hljs-keyword">null</span>;<br>        PreparedStatement pstm = <span class="hljs-keyword">null</span>;<br>        <span class="hljs-keyword">int</span> result = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">//1.获取连接</span><br>            conn = JDBCUtils.getConnection();<br>            <span class="hljs-comment">//2.获取操作对象</span><br>            pstm = conn.prepareStatement(<span class="hljs-string">&quot;insert into student(sid,name,age,birthday)values(null,?,?,?)&quot;</span>);<br>            <span class="hljs-comment">//3.设置参数</span><br>            <span class="hljs-comment">//pstm.setInt(1,null);</span><br>            pstm.setString(<span class="hljs-number">1</span>,student.getName());<br>            pstm.setInt(<span class="hljs-number">2</span>,student.getAge());<br>            pstm.setDate(<span class="hljs-number">3</span>,<span class="hljs-keyword">new</span> Date(student.getBirthday().getTime()));<br>            <span class="hljs-comment">//4.执行sql语句</span><br>            result = pstm.executeUpdate();<br>        &#125;<span class="hljs-keyword">catch</span> (Exception e)&#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> RuntimeException(e);<br>        &#125;<span class="hljs-keyword">finally</span> &#123;<br>            JDBCUtils.close(conn,pstm);<br>        &#125;<br>        <span class="hljs-keyword">return</span> result;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">update</span><span class="hljs-params">(Student student)</span> </span>&#123;<br>        <span class="hljs-comment">//定义必要信息</span><br>        Connection conn = <span class="hljs-keyword">null</span>;<br>        PreparedStatement pstm = <span class="hljs-keyword">null</span>;<br>        <span class="hljs-keyword">int</span> result = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">//1.获取连接</span><br>            conn = JDBCUtils.getConnection();<br>            <span class="hljs-comment">//2.获取操作对象</span><br>            pstm = conn.prepareStatement(<span class="hljs-string">&quot;update student set name=?,age=?,birthday=? where sid=? &quot;</span>);<br>            <span class="hljs-comment">//3.设置参数</span><br>            pstm.setString(<span class="hljs-number">1</span>,student.getName());<br>            pstm.setInt(<span class="hljs-number">2</span>,student.getAge());<br>            pstm.setDate(<span class="hljs-number">3</span>,<span class="hljs-keyword">new</span> Date(student.getBirthday().getTime()));<br>            pstm.setInt(<span class="hljs-number">4</span>,student.getSid());<br>            <span class="hljs-comment">//4.执行sql语句</span><br>            result = pstm.executeUpdate();<br>        &#125;<span class="hljs-keyword">catch</span> (Exception e)&#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> RuntimeException(e);<br>        &#125;<span class="hljs-keyword">finally</span> &#123;<br>            JDBCUtils.close(conn,pstm);<br>        &#125;<br>        <span class="hljs-keyword">return</span> result;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">delete</span><span class="hljs-params">(Integer sid)</span> </span>&#123;<br>        <span class="hljs-comment">//定义必要信息</span><br>        Connection conn = <span class="hljs-keyword">null</span>;<br>        PreparedStatement pstm = <span class="hljs-keyword">null</span>;<br>        <span class="hljs-keyword">int</span> result = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">//1.获取连接</span><br>            conn = JDBCUtils.getConnection();<br>            <span class="hljs-comment">//2.获取操作对象</span><br>            pstm = conn.prepareStatement(<span class="hljs-string">&quot;delete from student where sid=? &quot;</span>);<br>            <span class="hljs-comment">//3.设置参数</span><br>            pstm.setInt(<span class="hljs-number">1</span>,sid);<br>            <span class="hljs-comment">//4.执行sql语句</span><br>            result = pstm.executeUpdate();<br>        &#125;<span class="hljs-keyword">catch</span> (Exception e)&#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> RuntimeException(e);<br>        &#125;<span class="hljs-keyword">finally</span> &#123;<br>            JDBCUtils.close(conn,pstm);<br>        &#125;<br>        <span class="hljs-keyword">return</span> result;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure>

<h3 id="六、JDBC管理事务"><a href="#六、JDBC管理事务" class="headerlink" title="六、JDBC管理事务"></a>六、JDBC管理事务</h3><h4 id="1-介绍"><a href="#1-介绍" class="headerlink" title="1. 介绍"></a>1. 介绍</h4><ol>
<li>JDBC如何管理事务</li>
</ol>
<ul>
<li>管理事务的功能类：Connection</li>
<li>开启事务：setAutoCommit(boolean autoCommit);  参数为false，则开启事务。</li>
<li>提交事务：commit(); </li>
<li>回滚事务：rollback();</li>
</ul>
<h4 id="2-演示"><a href="#2-演示" class="headerlink" title="2. 演示"></a>2. 演示</h4><ul>
<li><p>演示批量添加数据并在业务层管理事务</p>
</li>
<li><p><strong>注意</strong>：事务的管理需要在业务层实现，因为dao层的功能要给很多模块提供功能的支撑，而有些模块是不需要事务的。</p>
</li>
<li><p>批量添加用户</p>
<p><img src="/2020/05/04/jdbc01/img/%E6%89%B9%E9%87%8F%E6%B7%BB%E5%8A%A0.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/2020/05/04/jdbc01/img/%E6%B7%BB%E5%8A%A0%E4%B8%89%E4%B8%AA.png" srcset="/img/loading.gif" lazyload></p>
</li>
<li><p>我们在这里可以批量添加三个用户</p>
</li>
</ul>
<h4 id="3-具体操作"><a href="#3-具体操作" class="headerlink" title="3. 具体操作"></a>3. 具体操作</h4><ul>
<li>UserService 接口</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">/*</span><br><span class="hljs-comment">	 批量添加 ： batch：一批，成批处理</span><br><span class="hljs-comment">*/</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">batchAdd</span><span class="hljs-params">(List&lt;User&gt; users)</span></span>;<br></code></pre></div></td></tr></table></figure>

<ul>
<li>UserServiceImpl 实现类：事务需要在service添加</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">/*</span><br><span class="hljs-comment">      事务要控制在此处</span><br><span class="hljs-comment">*/</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">batchAdd</span><span class="hljs-params">(List&lt;User&gt; users)</span> </span>&#123;<br>    <span class="hljs-comment">//获取数据库连接</span><br>    Connection connection = JDBCUtils.getConnection();<br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-comment">//开启事务</span><br>        connection.setAutoCommit(<span class="hljs-keyword">false</span>);<br>        <span class="hljs-keyword">for</span> (User user : users) &#123;<br>            <span class="hljs-comment">//1.创建ID,并把UUID中的-替换</span><br>            String uid = UUID.randomUUID().toString().replace(<span class="hljs-string">&quot;-&quot;</span>, <span class="hljs-string">&quot;&quot;</span>).toUpperCase();<br>            <span class="hljs-comment">//2.给user的uid赋值</span><br>            user.setUid(uid);<br>            <span class="hljs-comment">//3.生成员工编号</span><br>            user.setUcode(uid);<br><br>            <span class="hljs-comment">//模拟异常</span><br>            <span class="hljs-comment">//int n = 1 / 0;</span><br><br>            <span class="hljs-comment">//4.保存</span><br>            userDao.save(connection,user);<br>        &#125;<br>        <span class="hljs-comment">//提交事务</span><br>        connection.commit();<br>    &#125;<span class="hljs-keyword">catch</span> (Exception e)&#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">//回滚事务</span><br>            connection.rollback();<br>        &#125;<span class="hljs-keyword">catch</span> (Exception ex)&#123;<br>            ex.printStackTrace();<br>        &#125;<br>        e.printStackTrace();<br>    &#125;<span class="hljs-keyword">finally</span> &#123;<br>        JDBCUtils.close(connection,<span class="hljs-keyword">null</span>,<span class="hljs-keyword">null</span>);<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure>

<ul>
<li>UserDao 接口</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment">	支持事务的添加</span><br><span class="hljs-comment">*/</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">save</span><span class="hljs-params">(Connection connection,User user)</span></span>;<br></code></pre></div></td></tr></table></figure>

<ul>
<li>UserDaoImpl 实现类</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">/*</span><br><span class="hljs-comment">       支持事务的添加</span><br><span class="hljs-comment">*/</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">save</span><span class="hljs-params">(Connection connection, User user)</span> </span>&#123;<br>    <span class="hljs-comment">//定义必要信息</span><br>    PreparedStatement pstm = <span class="hljs-keyword">null</span>;<br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-comment">//1.获取连接</span><br>        connection = JDBCUtils.getConnection();<br>        <span class="hljs-comment">//2.获取操作对象</span><br>        pstm = connection.prepareStatement(<span class="hljs-string">&quot;insert into user(uid,ucode,loginname,password,username,gender,birthday,dutydate)values(?,?,?,?,?,?,?,?)&quot;</span>);<br>        <span class="hljs-comment">//3.设置参数</span><br>        pstm.setString(<span class="hljs-number">1</span>,user.getUid());<br>        pstm.setString(<span class="hljs-number">2</span>,user.getUcode());<br>        pstm.setString(<span class="hljs-number">3</span>,user.getLoginname());<br>        pstm.setString(<span class="hljs-number">4</span>,user.getPassword());<br>        pstm.setString(<span class="hljs-number">5</span>,user.getUsername());<br>        pstm.setString(<span class="hljs-number">6</span>,user.getGender());<br>        pstm.setDate(<span class="hljs-number">7</span>,<span class="hljs-keyword">new</span> Date(user.getBirthday().getTime()));<br>        pstm.setDate(<span class="hljs-number">8</span>,<span class="hljs-keyword">new</span> Date(user.getDutydate().getTime()));<br>        <span class="hljs-comment">//4.执行sql语句，获取结果集</span><br>        pstm.executeUpdate();<br>    &#125;<span class="hljs-keyword">catch</span> (Exception e)&#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> RuntimeException(e);<br>    &#125;<span class="hljs-keyword">finally</span> &#123;<br>        JDBCUtils.close(<span class="hljs-keyword">null</span>,pstm,<span class="hljs-keyword">null</span>);<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure>


            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/JDBC/">JDBC</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/JDBC/">JDBC</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">
                  
                    本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2020/05/04/Javaweb04/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Cookie&Session& Jsp</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2020/05/03/mysql03/">
                        <span class="hidden-mobile">MySQL高级-03</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
              <!-- Comments -->
              <article class="comments" id="comments" lazyload>
                
                  
                
                
  <div id="valine"></div>
  <script type="text/javascript">
    Fluid.utils.lazyComments('valine', function() {
      Fluid.utils.createScript('https://cdn.jsdelivr.net/npm/valine@1.4.14/dist/Valine.min.js', function () {
        new Valine({
          el: "#valine",
          app_id: "7FicXKczRMSUD3slGCpiLLto-gzGzoHsz",
          app_key: "L7N1wkygdm2UHsrq5DHTuMMk",
          placeholder: "说点什么",
          path: window.location.pathname,
          avatar: "retro",
          meta: ["nick","mail","link"],
          pageSize: "10",
          lang: "zh-CN",
          highlight: true,
          recordIP: true,
          serverURLs: "https://7ficxkcz.lc-cn-n1-shared.com",
        });
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the
    <a target="_blank" href="https://valine.js.org" rel="nofollow noopener noopener">comments powered by Valine.</a>
  </noscript>


              </article>
            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> <a target="_blank" href="https://www.12377.cn/" rel="nofollow noopener noopener">中央网信办（国家互联网信息办公室）违法和不良信息举报中心</a>

  </div>
  
  <div class="statistics">
    
    

    
      
        <!-- 不蒜子统计PV -->
        <span id="busuanzi_container_site_pv" style="display: none">
            总访问量 
            <span id="busuanzi_value_site_pv"></span>
             次
          </span>
      
      
        <!-- 不蒜子统计UV -->
        <span id="busuanzi_container_site_uv" style="display: none">
            总访客数 
            <span id="busuanzi_value_site_uv"></span>
             人
          </span>
      
    
  </div>


  
  <!-- 备案信息 -->
  <div class="beian">
    <span>
      <a href="http://beian.miit.gov.cn/" target="_blank" rel="nofollow noopener">
        京ICP证123456号
      </a>
    </span>
    
      
        <span>
          <a
            href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=12345678"
            rel="nofollow noopener"
            class="beian-police"
            target="_blank"
          >
            
              <span style="visibility: hidden; width: 0">|</span>
              <img src="/img/police_beian.png" srcset="/img/loading.gif" lazyload alt="police-icon"/>
            
            <span>京公网安备12345678号</span>
          </a>
        </span>
      
    
  </div>


  
  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" ></script>
<script  src="/js/debouncer.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  <script  src="https://cdn.jsdelivr.net/npm/tocbot@4.12.0/dist/tocbot.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4.3.0/anchor.min.js" ></script>



  <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js" ></script>



  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>


  <script defer src="/js/leancloud.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
      typing(title)
      
    })(window, document);
  </script>



  <script  src="/js/local-search.js" ></script>
  <script>
    (function () {
      var path = "/local-search.xml";
      $('#local-search-input').on('click', function() {
        searchFunc(path, 'local-search-input', 'local-search-result');
      });
      $('#modalSearch').on('shown.bs.modal', function() {
        $('#local-search-input').focus();
      });
    })()
  </script>





  

  
    <!-- MathJax -->
    <script>
      MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']]
        },
        options: {
          renderActions: {
            findScript: [10, doc => {
              document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
                const display = !!node.type.match(/; *mode=display/);
                const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
                const text = document.createTextNode('');
                node.parentNode.replaceChild(text, node);
                math.start = { node: text, delim: '', n: 0 };
                math.end = { node: text, delim: '', n: 0 };
                doc.math.push(math);
              });
            }, '', false],
            insertedScript: [200, () => {
              document.querySelectorAll('mjx-container').forEach(node => {
                let target = node.parentNode;
                if (target.nodeName.toLowerCase() === 'li') {
                  target.parentNode.classList.add('has-jax');
                }
              });
            }, '', false]
          }
        }
      };
    </script>

    <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/tex-svg.js" ></script>

  








  

  

  

  

  
    <!-- 51.la Analytics -->
    <script defer type="text/javascript" src="//js.users.51.la/21111747.js"></script>
  

  




  
<script src="/js/caidai.js"></script>
<script src="/js/dianjichuzi.js"></script>



<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>

  <script type="text/javascript" src="//js.users.51.la/21111747.js"></script>
</body>
</html>
